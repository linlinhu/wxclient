<template>
<div class="page grag-bg" data-page="customer-coupons">
    <div data-infinite-distance="50" class="page-content infinite-scroll-content" @infinite="loadMore">
		<div class="block-title"><a class="link back sub-back"><i class="icon-img"></i></a>我的优惠券</div>
		<ul class="coupon-lst" id="cuppons-view" cur=1></ul>
	</div>
</div>
</template>
<script>
	return {
		data: function () {
			return {
		        allowInfinite: true,
		        lastItem: 20,
      		}
    	},
    	methods: {
      		loadMore: function () {
		        var self = this;
		        var $ = self.$$;
		        if (!self.allowInfinite) return;
		        self.allowInfinite = false;

        		setTimeout(function () {
					if (self.lastItem >= 200) {
						$(self.$el).find('.preloader').remove();
			            return;
					}
					if ($('#cuppons-view').attr('hasNextPage') != "false") {
						loadAwardList(2);
					}

          			self.lastItem += 20;

          			self.allowInfinite = true;
        		}, 1000);
      		}
		}
  	}
</script>
